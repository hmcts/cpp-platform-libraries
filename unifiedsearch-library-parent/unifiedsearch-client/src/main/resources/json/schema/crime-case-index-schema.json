{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "http://justice.gov.uk/core/unfiedsearch/crime-case-index.json",

  "definitions": {
    "uuid": {
      "type": "string",
      "pattern": "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
    },

    "datePattern": {
      "type": "string",
      "pattern": "^((([\\+-]?\\d{4}(?!\\d{2}\\b))\\-(0[13578]|1[02])\\-(0[1-9]|[12]\\d|3[01]))|(([\\+-]?\\d{4}(?!\\d{2}\\b))\\-(0[13456789]|1[012])\\-(0[1-9]|[12]\\d|30))|(([\\+-]?\\d{4}(?!\\d{2}\\b))\\-02\\-(0[1-9]|1\\d|2[0-8]))|(((1[6-9]|[2-9]\\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))\\-02\\-29))$"
    },

    "nino": {
      "type": "string",
      "pattern": "(?!BG)(?!GB)(?!NK)(?!KN)(?!TN)(?!NT)(?!ZZ)(?:[A-CEGHJ-PR-TW-Z][A-CEGHJ-NPR-TW-Z])(?:\\s*\\d\\s*){6}([A-D]|\\s)$"
    },

    "address": {
      "type": "object",
      "properties": {
        "address1": {"type":  "string"},
        "address2": {"type":  "string"},
        "address3": {"type":  "string"},
        "address4": {"type":  "string"},
        "address5": {"type":  "string"},
        "postCode": {"type":  "string"}
      },
      "additionalProperties": false
    },

    "LAAReference": {
      "type": "object",
      "properties": {
        "applicationReference": {"type":  "string"},
        "statusId": {"type":  "string"},
        "statusCode": {"type":  "string"},
        "statusDescription": {"type":  "string"}
      },
      "additionalProperties": false
    },

    "representationOrder": {
      "type": "object",
      "properties": {
        "applicationReference": {"type":  "string"},
        "effectiveFromDate": {"$ref": "#/definitions/datePattern"},
        "effectiveToDate": {"$ref": "#/definitions/datePattern"},
        "laaContractNumber": {"type":  "string"}
      },
      "additionalProperties": false
    },


    "offence": {
      "type": "object",
      "properties": {
        "offenceId": {"type": "string"},
        "offenceCode": {"type": "string"},
        "offenceTitle": {"type": "string"},
        "offenceLegislation": {"type": "string"},
        "proceedingsConcluded": {"type": "boolean"},
        "arrestDate": {"$ref": "#/definitions/datePattern"},
        "dateOfInformation": {"$ref": "#/definitions/datePattern"},
        "endDate": {"$ref": "#/definitions/datePattern"},
        "startDate": {"$ref": "#/definitions/datePattern"},
        "chargeDate": {"$ref": "#/definitions/datePattern"},
        "modeOfTrial": {"type": "string"},
        "orderIndex": {"type": "integer"},
        "wording": {"type": "string"},
        "laaReference": {"$ref": "#/definitions/LAAReference"},
        "courtOrders": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/courtOrder"
          }
        },
        "pleas": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/plea"
          }
        },
        "verdict": {"$ref": "#/definitions/verdict"}
      },
        "required": ["offenceId"],
        "additionalProperties": false
    },

    "alias": {
      "type": "object",
      "properties": {
        "title": { "type": "string" },
        "firstName": { "type": "string" },
        "middleName": { "type": "string" },
        "lastName": { "type": "string" },
        "organisationName": { "type": "string" }
      },
      "additionalProperties": false
    },

    "party": {
      "type": "object",
      "properties": {
        "partyId": {
          "$ref": "#/definitions/uuid"
        },
        "croNumber": {
          "type": "string"
        },
        "courtProceedingsInitiated": {
          "type": "string",
          "format": "date-time"
        },
        "masterPartyId": {
          "$ref": "#/definitions/uuid"
        },
        "firstNameK": {
          "type": "string"
        },
        "lastNameK": {
          "type": "string"
        },
        "firstName": { "type": "string" },
        "middleName": { "type": "string" },
        "lastName": { "type": "string"},
        "title": { "type": "string" },
        "dateOfBirth": {
          "$ref": "#/definitions/datePattern"
        },
        "gender": { "type": "string" },
        "addressLines": { "type": "string" },
        "defendantAddress": {
          "$ref": "#/definitions/address"
        },
        "postCode": { "type": "string"},
        "pncId": { "type": "string" },
        "arrestSummonsNumber": { "type": "string" },
        "_party_type": { "type": "string" },
        "organisationName": { "type": "string" },
        "aliases": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/alias"
          }
        },
        "nationalInsuranceNumber": {"$ref": "#/definitions/nino"},
        "proceedingsConcluded": {"type":  "boolean"},
        "representationOrder": {"$ref": "#/definitions/representationOrder"},
        "offences": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/offence"
          }
        }
      },
      "required": ["partyId", "_party_type"],
      "additionalProperties": false
    },

    "hearingDay": {
      "type": "object",
      "properties": {
        "courtCentreId": {"type": "string"},
        "courtRoomId": {"type": "string"},
        "sittingDay": {"type": "string", "format": "date-time"},
        "listingSequence": {"type":  "integer"},
        "listedDurationMinutes": {"type":  "integer"},
        "hasSharedResults": { "type": "boolean" }
      },
      "additionalProperties": false
    },
    "defenceCounsel": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "title": {
          "type": "string"
        },
        "firstName": {
          "type": "string"
        },
        "middleName": {
          "type": "string"
        },
        "lastName": {
          "type": "string"
        },
        "status": {
          "type": "string"
        },
        "defendants": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/uuid"
          }
        },
        "attendanceDays": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/datePattern"
          }
        }
      },
      "additionalProperties": false
    },
    "verdictType": {
      "type": "object",
      "properties": {
        "verdictTypeId": {
          "$ref": "#/definitions/uuid"
        },
        "sequence": {
          "type": "integer"
        },
        "categoryType": {
          "type": "string"
        },
        "category": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "verdict": {
      "type": "object",
      "properties": {
        "originatingHearingId": {
          "$ref": "#/definitions/uuid"
        },
        "verdictDate": {
          "$ref": "#/definitions/datePattern"
        },
        "verdictType": {
          "$ref": "#/definitions/verdictType"
        }
      },
      "required": ["verdictType"],
      "additionalProperties": false
    },
    "hearing": {
      "type": "object",
      "properties": {
        "hearingId": {
          "$ref": "#/definitions/uuid"
        },
        "courtId": {
          "$ref": "#/definitions/uuid"
        },
        "courtCentreName": { "type": "string" },
        "courtCentreRoomId": { "$ref": "#/definitions/uuid" },
        "courtCentreRoomName": { "type": "string" },
        "courtCentreWelshName": { "type": "string" },
        "courtCentreRoomWelshName": { "type": "string"  },
        "courtCentreAddress": {
          "$ref": "#/definitions/address"
        },
        "courtCentreCode": { "type": "string"},
        "estimatedDuration": { "type": "string"},
        "hearingTypeId": { "type": "string" },
        "hearingTypeLabel": { "type": "string" },
        "hearingTypeCode": { "type": "string" },
        "hearingDates":  {
          "type": "array",
          "minItems": 0,
          "items": {
            "type": "string"
          }
        },
        "hearingDays": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/hearingDay"
          }
        },
        "defenceCounsels": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/defenceCounsel"
          }
        },
        "jurisdictionType": { "type": "string" },
        "judiciaryTypes": {
          "type": "array",
          "minItems": 0,
          "items": {
            "type": "string"
          }
        },
        "isBoxHearing": { "type": "boolean" },
        "isVirtualBoxHearing": { "type": "boolean" },
        "defendantIds": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/uuid"
          }
        }
      },
      "required": ["hearingId"],
      "additionalProperties": false
    },

    "application": {
      "type": "object",
      "properties": {
        "applicationId": {
          "$ref": "#/definitions/uuid"
        },
        "applicationReference": { "type": "string"},
        "applicationType": { "type": "string" },
        "applicationTypeCode": { "type": "string" },
        "receivedDate": {
          "$ref": "#/definitions/datePattern"
        },
        "applicationStatus": { "type": "string"},
        "applicationExternalCreatorType": { "type": "string"},
        "decisionDate": {
          "$ref": "#/definitions/datePattern"
        },
        "dueDate": {
          "$ref": "#/definitions/datePattern"
        },
        "subjectSummary": {
          "$ref": "#/definitions/subjectSummary"
        }
      },
      "required": ["applicationId"],
      "additionalProperties": false
    },

    "subjectSummary": {
      "type": "object",
      "properties": {
        "subjectId": {"type":  "string"},
        "masterDefendantId": {"type":  "string"},
        "organisationName": {"type":  "string"},
        "firstName": {"type":  "string"},
        "middleName": {"type":  "string"},
        "lastName": {"type":  "string"},
        "dateOfBirth": {"type":  "string"},
        "address": {
          "$ref": "#/definitions/address"
        }
      },
      "additionalProperties": false
    },


    "case": {
      "type": "object",
      "properties": {
        "caseId": {
          "$ref": "#/definitions/uuid"
        },
        "caseReference": { "type": "string" },
        "prosecutingAuthority": { "type": "string" },
        "caseStatus": { "type": "string" },
        "_case_type": { "type": "string" },
        "_is_sjp": { "type": "boolean" },
        "_is_magistrates": { "type": "boolean" },
        "_is_crown": { "type": "boolean" },
        "_is_charging": { "type": "boolean" },
        "sjpNoticeServed": {
          "$ref": "#/definitions/datePattern"
        },
        "parties": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/party"
          }
        },
        "hearings": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/hearing"
          }
        },
        "applications": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/application"
          }
        },
        "sourceSystemReference": { "type": "string" }
      },
      "required": ["caseId", "_case_type"],
      "additionalProperties": false
    },

    "multiCase": {
      "type": "object",
      "properties": {
        "caseDocuments": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/case"
          }
        }
      },
      "required": ["caseDocuments"],
      "additionalProperties": false
    },
    "courtOrder": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "judicialResultTypeId": {
          "$ref": "#/definitions/uuid"
        },
        "label": {
          "type": "string"
        },
        "orderDate": {
          "$ref": "#/definitions/datePattern"
        },
        "startDate": {
          "$ref": "#/definitions/datePattern"
        },
        "endDate": {
          "$ref": "#/definitions/datePattern"
        },
        "orderingHearingId": {
          "$ref": "#/definitions/uuid"
        },
        "isSJPOrder": {
          "type": "boolean"
        },
        "canBeSubjectOfBreachProceedings": {
          "type": "boolean"
        },
        "canBeSubjectOfVariationProceedings": {
          "type": "boolean"
        }
      },
      "required": [
        "id",
        "orderDate",
        "startDate"
      ],
      "additionalProperties": false
    },
    "plea": {
      "type": "object",
      "properties": {
        "originatingHearingId": {
          "$ref": "#/definitions/uuid"
        },
        "pleaValue": {
          "type": "string"
        },
        "pleaDate": {
          "$ref": "#/definitions/datePattern"
        }
      },
      "required": [
        "pleaValue",
        "pleaDate"
      ],
      "additionalProperties": false
    }


  },

  "oneOf": [
    { "$ref": "#/definitions/case" },
    { "$ref": "#/definitions/multiCase"}
  ]
}