{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "http://justice.gov.uk/core/unfiedsearch/cps-case-index.json",

  "definitions": {
    "uuid": {
      "type": "string",
      "pattern": "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
    },

    "datePattern": {
      "type": "string",
      "pattern": "^((([\\+-]?\\d{4}(?!\\d{2}\\b))\\-(0[13578]|1[02])\\-(0[1-9]|[12]\\d|3[01]))|(([\\+-]?\\d{4}(?!\\d{2}\\b))\\-(0[13456789]|1[012])\\-(0[1-9]|[12]\\d|30))|(([\\+-]?\\d{4}(?!\\d{2}\\b))\\-02\\-(0[1-9]|1\\d|2[0-8]))|(((1[6-9]|[2-9]\\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))\\-02\\-29))$"
    },

    "offence": {
      "type": "object",
      "properties": {
        "offenceId": {"type": "string"},
        "offenceCode": {"type": "string"},
        "custodyTimeLimit": {"$ref": "#/definitions/datePattern"},
        "type": {"type": "string"},
        "description": {"type": "string"},
        "startDate": {"$ref": "#/definitions/datePattern"},
        "endDate": {"$ref": "#/definitions/datePattern"}
      },
      "required": ["offenceId"],
      "additionalProperties": false
    },

    "alias": {
      "type": "object",
      "properties": {
        "firstName": { "type": "string" },
        "lastName": { "type": "string" }
      },
      "additionalProperties": false
    },

    "party": {
      "type": "object",
      "properties": {
        "partyId": {
          "$ref": "#/definitions/uuid"
        },
        "_party_type": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "firstName": { "type": "string" },
        "lastName": { "type": "string" },
        "aliases": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/alias"
          }
        },
        "dateOfBirth": {
          "$ref": "#/definitions/datePattern"
        },
        "asn": { "type": "string" },
        "pncId": { "type": "string" },
        "organisationName": {"type": "string"},
        "lastOrOrganisationName": {"type":  "string"},
        "oicShoulderNumber": {"type": "string" },
        "offences": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/offence"
          }
        }
      },
      "required": ["partyId", "_party_type"],
      "additionalProperties": false
    },

    "hearing": {
      "type": "object",
      "properties": {
        "hearingId": {
          "$ref": "#/definitions/uuid"
        },
        "hearingDateTime": {"type": "string", "format": "date-time"},
        "courtHouse": { "type": "string" },
        "courtRoom": { "type": "string" },
        "hearingType": { "type": "string" },
        "jurisdiction": { "type": "string" }
      },
      "required": ["hearingId"],
      "additionalProperties": false
    },

    "linkedCase": {
      "type": "object",
      "properties": {
        "linkedCaseId": {
          "$ref": "#/definitions/uuid"
        },
        "manuallyLinked": {"type": "boolean"}
      },
      "required": ["linkedCaseId"],
      "additionalProperties": false
    },


    "case": {
      "type": "object",
      "properties": {
        "caseId": {
          "$ref": "#/definitions/uuid"
        },
        "urn": {
          "type": "string"
        },
        "cpsUnitCode": {
          "type": "string"
        },
        "cjsAreaCodes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "cpsAreaCode": {
          "type": "string"
        },
        "caseType": {
          "type": "string"
        },
        "caseStatusCode": {
          "type": "string"
        },
        "operationName": {
          "type": "string"
        },
        "paralegalOfficer": {
          "type": "string"
        },
        "crownAdvocate": {
          "type": "string"
        },
        "prosecutor": {
          "type": "string"
        },
        "witnessCareUnitCode": {
          "type": "string"
        },
        "witnessCareOfficer": {
          "type": "string"
        },
        "unit": {
          "type": "string"
        },
        "unitGroup": {
          "type": "string"
        },
        "linked": {"type": "boolean"},
        "parties": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/party"
          }
        },
        "hearings": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/hearing"
          }
        },
        "linkedCases": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/linkedCase"
          }
        }
      },
      "required": ["caseId"],
      "additionalProperties": false
    },

    "multiCase": {
      "type": "object",
      "properties": {
        "caseDocuments": {
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/case"
          }
        }
      },
      "required": ["caseDocuments"],
      "additionalProperties": false
    }

  },

  "oneOf": [
    { "$ref": "#/definitions/case" },
    { "$ref": "#/definitions/multiCase"}
  ]
}